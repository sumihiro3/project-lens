# ProjectLens - 要件定義書

## 1. プロジェクト概要

### 1.1 目的
Backlogの課題管理を効率化し、ユーザーにとって重要な課題を自動的に優先順位付けして表示するデスクトップアプリケーションを提供する。

### 1.2 対象ユーザー
- Backlogを日常的に使用する開発者・プロジェクトマネージャー
- 複数のプロジェクトを同時に管理する必要があるユーザー
- 重要な課題を見逃したくないユーザー

### 1.3 解決する課題
- 大量の課題の中から重要なものを見つけるのが困難
- 複数プロジェクトの課題を一元管理できない
- 新しい重要課題の見逃し
- Backlog UIの操作が煩雑

## 2. 機能要件

### 2.1 認証・設定機能

#### FR-001: Backlog接続設定
- **優先度**: 必須
- **説明**: ユーザーがBacklogのドメインとAPIキーを設定できる
- **受け入れ基準**:
  - ドメイン入力フィールド（例: `example.backlog.com`）
  - APIキー入力フィールド（セキュアな入力）
  - 設定の保存・検証機能
  - 接続エラー時の適切なエラーメッセージ表示

#### FR-002: プロジェクト選択
- **優先度**: 必須
- **説明**: 監視対象のプロジェクトを選択できる
- **受け入れ基準**:
  - Backlogから利用可能なプロジェクト一覧を取得
  - 最大5プロジェクトまで選択可能
  - 選択したプロジェクトの保存
  - プロジェクト選択解除時のデータクリーンアップ

#### FR-003: 言語設定
- **優先度**: 必須
- **説明**: UIの表示言語を切り替えられる
- **受け入れ基準**:
  - 日本語・英語の切り替え
  - 設定の永続化
  - アプリ全体への即座の反映

### 2.2 課題管理機能

#### FR-004: 課題同期
- **優先度**: 必須
- **説明**: Backlogから課題情報を取得・同期する
- **受け入れ基準**:
  - 初回起動時の手動同期
  - 5分ごとの自動バックグラウンド同期
  - 完了済み課題の除外
  - 同期状態の表示（最終同期時刻）
  - 同期エラー時の適切なハンドリング

#### FR-005: 課題表示
- **優先度**: 必須
- **説明**: 取得した課題を一覧表示する
- **受け入れ基準**:
  - 課題カード形式での表示
  - 以下の情報を表示:
    - プロジェクトキー（色分けバッジ）
    - 課題キー・タイトル
    - 種別（バグ、タスク、要望など）
    - 優先度
    - ステータス
    - 担当者
    - 期限日
    - 更新日時（相対表示）
    - 関連度スコア
  - スクロール可能なリスト
  - レスポンシブなレイアウト

#### FR-006: スコアリングシステム
- **優先度**: 必須
- **説明**: 各課題に関連度スコア（0-150点）を自動計算する
- **受け入れ基準**:
  - 以下の要素を考慮したスコア計算:
    - 優先度（高: +30点、中: +15点）
    - 期限（期限切れ: +40点、今日: +30点、今週: +20点、今月: +10点）
    - 担当者（自分: +50点）
    - ステータス（未対応: +20点、処理中: +10点）
  - スコアの視覚的表示
  - スコア順でのデフォルト表示

### 2.3 フィルタリング・ソート機能

#### FR-007: ステータスフィルター
- **優先度**: 必須
- **説明**: ステータスで課題を絞り込む
- **受け入れ基準**:
  - 「すべて」「未処理」「処理中」の選択肢
  - フィルター適用時の即座の反映
  - フィルター状態の保持（画面遷移後も維持）

#### FR-008: 期限フィルター
- **優先度**: 必須
- **説明**: 期限で課題を絞り込む
- **受け入れ基準**:
  - 「期限なし」「期限切れ」「今日」「今週」「今月」の選択肢
  - 日付計算の正確性
  - フィルター状態の保持

#### FR-009: 優先度・担当者・プロジェクトフィルター
- **優先度**: 必須
- **説明**: 複数の条件で課題を絞り込む
- **受け入れ基準**:
  - 優先度の複数選択
  - 担当者の複数選択
  - プロジェクトの複数選択
  - 利用可能な選択肢の動的生成
  - AND条件での絞り込み

#### FR-010: スコアフィルター
- **優先度**: 推奨
- **説明**: 最小スコアで課題を絞り込む
- **受け入れ基準**:
  - スライダーまたは数値入力での設定
  - リアルタイムフィルタリング

#### FR-011: 検索機能
- **優先度**: 必須
- **説明**: キーワードで課題を検索する
- **受け入れ基準**:
  - 課題キー、タイトル、説明文での検索
  - 部分一致検索
  - 大文字小文字を区別しない検索

#### FR-012: ソート機能
- **優先度**: 必須
- **説明**: 複数の基準で課題を並び替える
- **受け入れ基準**:
  - 以下の並び替えオプション:
    - 関連度スコア（デフォルト）
    - 期限日
    - 優先度（重み付け: 高→中→低）
    - 更新日
  - 昇順・降順の切り替え
  - デフォルトで降順
  - 並び替え基準変更時に降順にリセット

### 2.4 通知機能

#### FR-013: 高スコア課題通知
- **優先度**: 必須
- **説明**: 重要な課題を自動通知する
- **受け入れ基準**:
  - スコア80点以上の課題を検出
  - 新規課題または新たに80点以上になった課題のみ通知
  - システム通知の表示
  - 通知音の再生（macOS）
  - 通知内容: 課題タイトルとスコア

### 2.5 UI/UX機能

#### FR-014: ブラウザ連携
- **優先度**: 必須
- **説明**: Backlogのチケットページをブラウザで開く
- **受け入れ基準**:
  - チケットタイトルクリックで開く
  - 「開く」ボタンで開く
  - デフォルトブラウザでの表示
  - 正しいURLの生成

#### FR-015: ダークモード対応
- **優先度**: 推奨
- **説明**: OSのテーマ設定に応じた表示
- **受け入れ基準**:
  - ライトモード・ダークモードの自動切り替え
  - 視認性の確保
  - コントラスト比の適切な調整

#### FR-016: ウィンドウ状態の保存
- **優先度**: 推奨
- **説明**: ウィンドウサイズと位置を記憶する
- **受け入れ基準**:
  - アプリ終了時の状態保存
  - 次回起動時の復元
  - 複数ディスプレイ環境での適切な動作

#### FR-017: ツールチップ
- **優先度**: 推奨
- **説明**: ボタンやアイコンに説明を表示する
- **受け入れ基準**:
  - 主要なボタンにツールチップを配置
  - ホバー時の表示
  - 多言語対応

#### FR-018: 相対時間表示
- **優先度**: 推奨
- **説明**: 更新日時を相対的に表示する
- **受け入れ基準**:
  - 「たった今」「1分前」「1時間前」「1日前」などの表示
  - 1週間以上前は日付表示
  - 日本語での自然な表現

## 3. 非機能要件

### 3.1 パフォーマンス

#### NFR-001: 起動時間
- アプリケーション起動から使用可能になるまで5秒以内

#### NFR-002: 同期速度
- 100件の課題の同期を10秒以内に完了

#### NFR-003: UI応答性
- ユーザー操作に対して100ms以内に反応

### 3.2 セキュリティ

#### NFR-004: 認証情報の保護
- APIキーはローカルデータベースに暗号化して保存
- メモリ上での適切な管理

#### NFR-005: 通信の安全性
- Backlog APIとの通信はHTTPS経由のみ

### 3.3 可用性

#### NFR-006: オフライン動作
- ネットワーク接続がない場合でもキャッシュデータを表示
- 同期エラー時の適切なエラーメッセージ

#### NFR-007: データ永続性
- ローカルデータベースによる課題データの保存
- アプリ再起動後もデータを保持

### 3.4 互換性

#### NFR-008: OS対応
- macOS 11以降をサポート
- Windows 10以降をサポート（将来的）
- Linux（将来的）

#### NFR-009: Backlog API互換性
- Backlog API v2に準拠

### 3.5 保守性

#### NFR-010: コード品質
- TypeScriptによる型安全性の確保
- Rustによる安全なバックエンド処理
- 適切なエラーハンドリング

#### NFR-011: ログ
- デバッグ用のログ出力
- エラー発生時の詳細情報記録

## 4. 制約事項

### 4.1 技術的制約
- Backlog APIのレート制限に準拠
- 最大5プロジェクトまでの同時管理
- 完了済み課題は同期対象外

### 4.2 運用制約
- インターネット接続が必要（初回同期・定期同期時）
- Backlog APIキーの取得が必要

## 5. 将来的な拡張

### 5.1 検討中の機能
- カスタムフィルターの保存
- 課題の一括操作
- グラフ・統計表示
- カスタムスコアリングルール
- Slack/Teams連携
- モバイルアプリ版

### 5.2 改善予定
- パフォーマンス最適化
- より詳細な通知設定
- キーボードショートカット
- エクスポート機能

## 6. 変更履歴

| 日付 | バージョン | 変更内容 |
|------|-----------|---------|
| 2025-11-25 | 1.0 | 初版作成 |
